# 📐 问卷数据分析方法论

## 1. 数据质量控制框架

### 1.1 数据清洗标准

#### 缺失值处理
- **完全缺失**：删除缺失率>30%的样本
- **部分缺失**：使用均值/中位数插补（连续变量）或众数插补（分类变量）
- **系统性缺失**：分析缺失模式，判断是否MCAR/MAR/MNAR

#### 异常值检测
```r
# 方法1：箱线图法（IQR）
Q1 <- quantile(data, 0.25)
Q3 <- quantile(data, 0.75)
IQR <- Q3 - Q1
outliers <- data < (Q1 - 1.5*IQR) | data > (Q3 + 1.5*IQR)

# 方法2：Z-score法
z_scores <- scale(data)
outliers <- abs(z_scores) > 3

# 方法3：Mahalanobis距离（多变量）
```

#### 注意力检查
- 设置反向题检测矛盾回答
- 答题时长过滤（过快<2分钟，过慢>30分钟）
- 直线作答检测（标准差<0.5）

### 1.2 样本代表性检验
- 性别、年龄、地域分布与总体对比
- 卡方检验验证样本结构
- 加权调整（如需要）

## 2. 描述性统计分析

### 2.1 集中趋势
- **均值**：适用于正态分布数据
- **中位数**：适用于偏态分布或有异常值
- **众数**：适用于分类数据

### 2.2 离散程度
- **标准差**：数据波动程度
- **变异系数**：CV = SD/Mean，用于不同量纲比较
- **四分位距**：稳健的离散度量

### 2.3 分布形态
- **偏度**：分布对称性（-0.5~0.5为正态）
- **峰度**：分布尖峭程度（-1~1为正态）
- **K-S检验**：正态性检验

## 3. 相关分析方法

### 3.1 相关系数选择

| 数据类型 | 方法 | 适用条件 |
|---------|------|---------|
| 连续-连续 | Pearson | 线性关系、正态分布 |
| 连续-连续 | Spearman | 单调关系、非正态 |
| 有序-有序 | Kendall's τ | 小样本、有序分类 |
| 二分-连续 | Point-biserial | 二分变量与连续变量 |

### 3.2 相关强度判断
- |r| < 0.3：弱相关
- 0.3 ≤ |r| < 0.5：中等相关
- |r| ≥ 0.5：强相关

### 3.3 显著性检验
- p < 0.05：显著
- p < 0.01：非常显著
- p < 0.001：极其显著

**注意**：大样本下易出现统计显著但实际意义不大的相关

## 4. 因子分析流程

### 4.1 适用性检验
```r
# KMO检验（>0.6可接受，>0.8良好）
KMO(data)

# Bartlett球形检验（p<0.05拒绝原假设）
cortest.bartlett(cor(data), n=nrow(data))
```

### 4.2 因子提取
- **特征值>1准则**（Kaiser准则）
- **碎石图拐点法**
- **累计方差贡献率>60%**

### 4.3 旋转方法
- **正交旋转**（Varimax）：假设因子独立
- **斜交旋转**（Oblimin）：允许因子相关

### 4.4 因子命名
- 载荷>0.5的题项归入该因子
- 根据题项内容提炼因子含义

## 5. 信度与效度分析

### 5.1 信度（Reliability）
```r
# Cronbach's Alpha
# α > 0.9：优秀
# α > 0.8：良好
# α > 0.7：可接受
# α > 0.6：勉强接受（探索性研究）

psych::alpha(data)
```

### 5.2 效度（Validity）
- **内容效度**：专家评审
- **结构效度**：因子分析
- **收敛效度**：AVE > 0.5
- **区分效度**：AVE平方根 > 因子间相关

## 6. 聚类分析方法

### 6.1 K-means聚类
```r
# 确定最优K值
# 方法1：肘部法则（Within SS）
# 方法2：轮廓系数法（Silhouette）
# 方法3：Gap统计量

fviz_nbclust(data, kmeans, method = "silhouette")
```

### 6.2 聚类质量评估
- **轮廓系数**：0.5-0.7合理，>0.7强结构
- **类内平方和**：越小越好
- **类间差异显著性**：ANOVA检验

### 6.3 聚类解释
- 各类别在关键变量上的均值对比
- 人口统计学特征分布
- 为每个类别命名（如"高接受度用户"）

## 7. 回归分析框架

### 7.1 模型假设检验
```r
# 1. 线性关系：残差图
plot(model, which=1)

# 2. 正态性：Q-Q图
plot(model, which=2)

# 3. 同方差性：Scale-Location图
plot(model, which=3)

# 4. 多重共线性：VIF<10
car::vif(model)

# 5. 独立性：Durbin-Watson检验
car::durbinWatsonTest(model)
```

### 7.2 模型评估
- **R²**：解释变异比例
- **调整R²**：考虑变量数的R²
- **F检验**：模型整体显著性
- **AIC/BIC**：模型比较（越小越好）

### 7.3 系数解释
- **标准化系数β**：比较不同变量的相对重要性
- **非标准化系数B**：实际预测使用
- **p值**：系数显著性
- **95%置信区间**：系数估计精度

## 8. 统计功效与样本量

### 8.1 样本量估算
```r
# 相关分析：r=0.3, power=0.8, α=0.05
pwr::pwr.r.test(r=0.3, sig.level=0.05, power=0.8)

# 回归分析：f²=0.15, power=0.8
pwr::pwr.f2.test(u=5, f2=0.15, sig.level=0.05, power=0.8)
```

### 8.2 效应量
- **Cohen's d**：均值差异（0.2小，0.5中，0.8大）
- **η²**：方差分析效应量
- **R²**：回归模型效应量

## 9. 报告撰写规范

### 9.1 统计结果报告格式
```
# 相关分析
r = 0.45, p < 0.001

# t检验
t(208) = 3.21, p = 0.002, d = 0.45

# 回归分析
β = 0.35, SE = 0.08, t = 4.38, p < 0.001, 95% CI [0.19, 0.51]

# 方差分析
F(2, 205) = 12.34, p < 0.001, η² = 0.11
```

### 9.2 图表规范
- 标题清晰、自解释
- 坐标轴标签完整（含单位）
- 图例位置合理
- 配色友好（色盲友好）
- 分辨率≥300dpi（出版用）

## 10. 常见陷阱与注意事项

### ⚠️ 统计陷阱
1. **相关≠因果**：需要理论支撑和实验设计
2. **p值滥用**：关注效应量，不只看显著性
3. **多重比较**：需要Bonferroni校正
4. **样本选择偏差**：注意样本代表性
5. **过度拟合**：模型复杂度与样本量匹配

### ✅ 最佳实践
1. **预注册研究**：事先声明假设和分析计划
2. **报告所有分析**：包括不显著结果
3. **开放数据和代码**：提高可重复性
4. **敏感性分析**：检验结果稳健性
5. **效应量优先**：不只关注p值

## 参考文献

1. Field, A. (2013). Discovering Statistics Using IBM SPSS Statistics. Sage.
2. Tabachnick, B. G., & Fidell, L. S. (2013). Using Multivariate Statistics. Pearson.
3. Hair, J. F., et al. (2010). Multivariate Data Analysis. Pearson.
4. Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences. Routledge.

---

**持续更新中** | 最后更新：2025年
