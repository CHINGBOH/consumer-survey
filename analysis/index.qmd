---
title: "æ•°æ®åˆ†ææ¡†æ¶"
subtitle: "æ¶ˆè´¹è¡Œä¸ºæ•°æ®çš„ç»Ÿè®¡åˆ†æä¸å¯è§†åŒ–"
author: "è°ƒç ”å›¢é˜Ÿ"
date: today
format: html
---

# ğŸ“Š æ•°æ®åˆ†ææ¡†æ¶

## ğŸ¯ åˆ†ææµç¨‹

```mermaid
graph TD
    A[æ•°æ®æ”¶é›†] --> B[æ•°æ®æ¸…æ´—]
    B --> C[æè¿°æ€§ç»Ÿè®¡]
    C --> D[æ¢ç´¢æ€§åˆ†æ]
    D --> E[å‡è®¾æ£€éªŒ]
    E --> F[å›å½’åˆ†æ]
    F --> G[èšç±»åˆ†æ]
    G --> H[ç»“æœè§£è¯»]
    H --> I[æŠ¥å‘Šç”Ÿæˆ]
```

## ğŸ“‹ æ•°æ®é¢„å¤„ç†

### æ•°æ®è´¨é‡æ£€æŸ¥

```{r}
#| label: data-quality-check
#| echo: true
#| eval: false

# åŠ è½½å¿…è¦çš„åŒ…
library(tidyverse)
library(janitor)

# è¯»å–æ•°æ®
raw_data <- read_csv("data/survey_raw.csv")

# æ•°æ®æ¦‚è§ˆ
glimpse(raw_data)

# æ£€æŸ¥ç¼ºå¤±å€¼
missing_summary <- raw_data %>%
  summarise_all(~sum(is.na(.))) %>%
  pivot_longer(everything(), names_to = "variable", values_to = "missing_count")

# æ£€æŸ¥é‡å¤è®°å½•
duplicate_count <- sum(duplicated(raw_data))

# æ•°æ®è´¨é‡æŠ¥å‘Š
cat("æ•°æ®è´¨é‡æ£€æŸ¥ç»“æœï¼š\n")
cat("æ€»è®°å½•æ•°ï¼š", nrow(raw_data), "\n")
cat("é‡å¤è®°å½•æ•°ï¼š", duplicate_count, "\n")
cat("ç¼ºå¤±å€¼æœ€å¤šçš„å˜é‡ï¼š\n")
missing_summary %>% arrange(desc(missing_count)) %>% head(5)
```

### æ•°æ®æ¸…æ´—

```{r}
#| label: data-cleaning
#| echo: true
#| eval: false

# æ•°æ®æ¸…æ´—æµç¨‹
clean_data <- raw_data %>%
  # ç§»é™¤å®Œå…¨é‡å¤çš„è®°å½•
  distinct() %>%
  # å¤„ç†ç¼ºå¤±å€¼
  mutate(
    age = ifelse(is.na(age), median(age, na.rm = TRUE), age),
    income = ifelse(is.na(income), "æœªå¡«å†™", income)
  ) %>%
  # æ•°æ®ç±»å‹è½¬æ¢
  mutate(
    age_group = cut(age, breaks = c(0, 20, 25, 30, 100),
                   labels = c("18-20", "21-25", "26-30", "30+")),
    gender = factor(gender, levels = c("ç”·", "å¥³"))
  ) %>%
  # ç§»é™¤å¼‚å¸¸å€¼
  filter(age >= 18 & age <= 80)

# ä¿å­˜æ¸…æ´—åçš„æ•°æ®
write_csv(clean_data, "data/survey_clean.csv")
```

## ğŸ“ˆ æè¿°æ€§ç»Ÿè®¡

### åŸºæœ¬ç»Ÿè®¡é‡

```{r}
#| label: descriptive-stats
#| echo: true
#| eval: false

# æ•°å€¼å˜é‡ç»Ÿè®¡
numeric_summary <- clean_data %>%
  select(where(is.numeric)) %>%
  summary()

# åˆ†ç±»å˜é‡ç»Ÿè®¡
categorical_summary <- clean_data %>%
  select(where(is.factor) | where(is.character)) %>%
  pivot_longer(everything()) %>%
  count(name, value) %>%
  group_by(name) %>%
  mutate(prop = n / sum(n)) %>%
  ungroup()
```

### æ•°æ®å¯è§†åŒ–

```{r}
#| label: basic-plots
#| echo: true
#| eval: false
#| fig-cap: "å¹´é¾„åˆ†å¸ƒç›´æ–¹å›¾"

# å¹´é¾„åˆ†å¸ƒ
ggplot(clean_data, aes(x = age)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "white") +
  theme_minimal() +
  labs(title = "å—è®¿è€…å¹´é¾„åˆ†å¸ƒ",
       x = "å¹´é¾„", y = "é¢‘æ•°")
```

## ğŸ” æ¢ç´¢æ€§æ•°æ®åˆ†æ (EDA)

### ç›¸å…³æ€§åˆ†æ

```{r}
#| label: correlation-analysis
#| echo: true
#| eval: false

# é€‰æ‹©æ•°å€¼å˜é‡è¿›è¡Œç›¸å…³æ€§åˆ†æ
numeric_vars <- clean_data %>% select(where(is.numeric))

# è®¡ç®—ç›¸å…³ç³»æ•°çŸ©é˜µ
cor_matrix <- cor(numeric_vars, use = "complete.obs")

# å¯è§†åŒ–ç›¸å…³æ€§çŸ©é˜µ
library(corrplot)
corrplot(cor_matrix, method = "color", type = "upper",
         addCoef.col = "black", tl.col = "black")
```

### ç»„é—´å·®å¼‚åˆ†æ

```{r}
#| label: group-differences
#| echo: true
#| eval: false

# æ€§åˆ«å·®å¼‚åˆ†æ
gender_analysis <- clean_data %>%
  group_by(gender) %>%
  summarise(
    n = n(),
    mean_age = mean(age, na.rm = TRUE),
    mean_income = mean(as.numeric(income), na.rm = TRUE),
    .groups = "drop"
  )

# tæ£€éªŒï¼šæ€§åˆ«ä¸æ¶ˆè´¹é‡‘é¢å·®å¼‚
t_test_result <- t.test(monthly_spending ~ gender, data = clean_data)
```

## ğŸ“Š é«˜çº§åˆ†ææ–¹æ³•

### å› å­åˆ†æ

```{r}
#| label: factor-analysis
#| echo: true
#| eval: false

library(psych)

# å› å­åˆ†æ
fa_result <- fa(clean_data[, consumption_vars], nfactors = 3, rotate = "varimax")

# å› å­è½½è·
print(fa_result$loadings)

# å¯è§†åŒ–å› å­è½½è·
fa.diagram(fa_result)
```

### èšç±»åˆ†æ

```{r}
#| label: cluster-analysis
#| echo: true
#| eval: false

# K-meansèšç±»
set.seed(123)
kmeans_result <- kmeans(scale(numeric_vars), centers = 3)

# æ·»åŠ èšç±»æ ‡ç­¾
clustered_data <- clean_data %>%
  mutate(cluster = as.factor(kmeans_result$cluster))

# å¯è§†åŒ–èšç±»ç»“æœ
ggplot(clustered_data, aes(x = PC1, y = PC2, color = cluster)) +
  geom_point() +
  theme_minimal() +
  labs(title = "æ¶ˆè´¹è¡Œä¸ºèšç±»åˆ†æ")
```

## ğŸ¯ å‡è®¾æ£€éªŒ

### å¡æ–¹æ£€éªŒ

```{r}
#| label: chi-square-test
#| echo: true
#| eval: false

# æ€§åˆ«ä¸æ¶ˆè´¹åå¥½å…³è”
chisq_result <- chisq.test(table(clean_data$gender, clean_data$shopping_preference))

print(chisq_result)
```

### æ–¹å·®åˆ†æ

```{r}
#| label: anova-test
#| echo: true
#| eval: false

# å¹´é¾„ç»„ä¸æ¶ˆè´¹é‡‘é¢å·®å¼‚
anova_result <- aov(monthly_spending ~ age_group, data = clean_data)

summary(anova_result)

# äº‹åæ£€éªŒ
TukeyHSD(anova_result)
```

## ğŸ“ˆ å›å½’åˆ†æ

### å¤šå…ƒçº¿æ€§å›å½’

```{r}
#| label: regression-analysis
#| echo: true
#| eval: false

# æ¶ˆè´¹è¡Œä¸ºå½±å“å› ç´ åˆ†æ
regression_model <- lm(monthly_spending ~ age + gender + education + income,
                       data = clean_data)

# æ¨¡å‹æ‘˜è¦
summary(regression_model)

# æ¨¡å‹è¯Šæ–­
par(mfrow = c(2, 2))
plot(regression_model)
```

## ğŸ“‹ åˆ†ææŠ¥å‘Šç”Ÿæˆ

### è‡ªåŠ¨åŒ–æŠ¥å‘Š

```{r}
#| label: automated-report
#| echo: true
#| eval: false

library(rmarkdown)

# ç”Ÿæˆåˆ†ææŠ¥å‘Š
render("analysis_report.Rmd",
       output_file = "æ¶ˆè´¹è¡Œä¸ºåˆ†ææŠ¥å‘Š.html",
       params = list(data = clean_data))
```

---

::: {.callout-tip}
## ğŸ’¡ åˆ†æå»ºè®®

1. **æ•°æ®è´¨é‡ç¬¬ä¸€**ï¼šå®å¯å°‘è€Œç²¾ï¼Œä¸è¦å¤šè€Œä¹±
2. **å¯è§†åŒ–å…ˆè¡Œ**ï¼šå›¾è¡¨æ¯”æ•°å­—æ›´æœ‰è¯´æœåŠ›
3. **å‡è®¾æ£€éªŒä¸¥è°¨**ï¼šç¡®ä¿ç»Ÿè®¡æ–¹æ³•é€‰æ‹©æ­£ç¡®
4. **ç»“æœè§£è¯»æ·±å…¥**ï¼šä¸ä»…çœ‹på€¼ï¼Œæ›´è¦çœ‹å®é™…æ„ä¹‰
:::</content>
<parameter name="filePath">C:\Users\l\Documents\GitHub\SurveyAnalysis\analysis\index.qmd